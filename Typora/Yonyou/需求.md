### 预制函数

#### PTPSUM             

|                              |                          计算逻辑                          |
| :--------------------------- | :--------------------------------------------------------: |
| 负债类科目   Asset/Liability |      V(1)*P(1)+....+V(n)*P(n)-V(max)*P(max)#lastYear       |
| 非负债类科目                 |                  V(1)*P(1)+....+V(n)*P(n)                  |
|                              | V---value 数值   P ---POWN 股权   n----当前月  max最大月份 |

打算



| 4次执行时间对比(6000条数据) | 随机分块（查询+计算）75w | 按主体和年分块（查询+计算）75w | 按主体分块260W | 按年和主体分块260w |
| :-------------------------: | :----------------------: | :----------------------------: | :------------: | :----------------: |
|              1              |          382ms           |             218ms              |                |       85+179       |
|              2              |      167ms = 83+84       |           88ms=3+85            |  68ms = 9+59   |     86ms=10+76     |
|              3              |       202ms=92+110       |           94ms=4+94            |   77ms=12+65   |     65ms=10+55     |
|              4              |       173ms=88+85        |           67ms=3+64            |   83ms=10+73   |     79ms=11+68     |

| 4次执行时间对比(6000条数据) | 按年和主体跨分块计算，来源两个不同的主体 |      |
| --------------------------- | ---------------------------------------- | ---- |
| 1                           |                                          |      |
| 2                           | 11+85,       12+88                       |      |
| 3                           | 9+96,         11+90                      |      |
| 4                           | 10+106,      9+100                       |      |

